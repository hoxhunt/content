category: Utilities
commonfields:
  id: Hoxhunt
  version: -1
configuration:
- display: API Key
  additionalinfo: Your personal API token, created in Hoxhunt settings
  name: api_key
  required: true
  type: 4
- defaultvalue: https://app.hoxhunt.com/graphql-external
  display: Hoxhunt API URL
  name: api_url
  required: false
  type: 0
- defaultvalue: 200
  display: Maximum amount of objects the integration commands can fetch at once
  name: max_fetch
  required: false
  type: 0
description: 'Ingest user-reported phishing, email compromise, or other similar incidents from the Hoxhunt platform.'
detaileddescription: 'Use this integration to retrieve collections of user-reported Threats (Incidents) as well as
  Threats associated with a single Incident. To use this integration, you need a Hoxhunt admin user account and an
  API key.'
display: Hoxhunt
name: Hoxhunt
script:
  script: ''
  commands:
  - name: hoxhunt-get-incidents
    description: 'Fetches a list of Hoxhunt Incident objects using supplied arguments.'
    arguments:
    - name: is_escalated
      description: 'Whether the command should fetch Incidents escalated by Hoxhunt or not. Use a boolean value,
        or leave empty to fetch both escalated and non-escalated Incidents.'
      default: false
      isArray: false
      secret: false
      required: false
    - name: first_reported_at
      description: 'Filter Incidents that were first reported after this time. Use an ISO 8601 timestamp format
        or timeago-style, i.e. "2 weeks".'
      default: false
      isArray: false
      secret: false
      required: false
    - name: last_reported_at
      description: 'Filter Incidents that were last reported after this time. Use an ISO 8601 timestamp format
        or timeago-style, i.e. "2 weeks".'
      default: false
      isArray: false
      secret: false
      required: false
    - name: sort_by
      description: 'Field to sort Incidents by. Possible values: CreatedAt, UpdatedAt. Prefix with "-" for reverse order. CreatedAt by default (oldest by creation first). '
      default: false
      isArray: false
      secret: false
      required: false
    - name: page_size
      description: 'Amount of Incidents to fetch at once. Defaults to the max_fetch integration parameter.'
      default: false
      isArray: false
      secret: false
      required: false
    - name: page
      description: 'Set of Incidents to fetch. Defaults to 1.'
      default: false
      isArray: false
      secret: false
      required: false
    outputs:
    - contextPath: Hoxhunt.Incident.Id
      description: 'Machine-generated ID of the Incident'
      type: String
    - contextPath: Hoxhunt.Incident.HumanReadableId
      description: 'Human-readable ID of the Incident'
      type: String
    - contextPath: Hoxhunt.Incident.CreatedAt
      description: 'ISO 8601 timestamp string of when the Incident was created'
      type: String
    - contextPath: Hoxhunt.Incident.UpdatedAt
      description: 'ISO 8601 timestamp string of when the Incident was last updated'
      type: String
    - contextPath: Hoxhunt.Incident.FirstReportedAt
      description: 'ISO 8601 timestamp string of when the Incident was first reported'
      type: String
    - contextPath: Hoxhunt.Incident.LastReportedAt
      description: 'ISO 8601 timestamp string of when the Incident was last reported'
      type: String
    - contextPath: Hoxhunt.Incident.Type
      description: 'Incident type. Possible values: "USER_ACTED_ON_THREAT", "BUSINESS_EMAIL_COMPROMISE", or "CAMPAIGN"'
      type: String
    - contextPath: Hoxhunt.Incident.Severity
      description: 'Incident severity. Possible values: "PHISH", "SPEAR", or "COMPROMISED_EMAIL"'
      type: String
    - contextPath: Hoxhunt.Incident.State
      description: 'Incident state. Possible values: "OPEN"'
      type: String
    - contextPath: Hoxhunt.Incident.ThreatCount
      description: 'Amount of Threats associated with this Incident. For Incidents with type "USER_ACTED_ON_THREAT", this is always 1'
      type: Number
    - contextPath: Hoxhunt.Incident.EscalatedAt
      description: 'ISO 8601 timestamp string of when the Incident was escalated by Hoxhunt. If the Incident is not escalated, this field is NULL'
      type: String
    - contextPath: Hoxhunt.Incident.EscalationThreshold
      description: 'The amount of Threats that caused the Incident to be escalated. If the Incident is not escalated, or if its Type is "USER_ACTED_ON_THREAT", this field is NULL'
      type: Number
  - name: hoxhunt-get-incident-threats
    description: 'Fetches a list of Hoxhunt Threat objects associated with an Incident using supplied arguments.'
    arguments:
    - name: incident_id
      description: 'Human-readable ID of the Incident you want to fetch Threats for.'
      default: true
      isArray: false
      secret: false
      required: true
    - name: sort_by
      description: 'Field to sort Incidents by. Possible values: CreatedAt, UpdatedAt. Prefix with "-" for reverse order. CreatedAt by default (oldest by creation first). '
      default: false
      isArray: false
      secret: false
      required: false
    - name: page_size
      description: 'Amount of Incidents to fetch at once. Defaults to the max_fetch integration parameter.'
      default: false
      isArray: false
      secret: false
      required: false
    - name: page
      description: 'Set of Incidents to fetch. Defaults to 1.'
      default: false
      isArray: false
      secret: false
      required: false
    outputs:
    - contextPath: Hoxhunt.Threat.Id
      description: 'Machine-generated ID of the Threat'
      type: String
    - contextPath: Hoxhunt.Threat.CreatedAt
      description: 'ISO 8601 timestamp string of when the Threat was created'
      type: String
    - contextPath: Hoxhunt.Threat.UpdatedAt
      description: 'ISO 8601 timestamp string of when the Threat was last updated'
      type: String
    - contextPath: Hoxhunt.Threat.Severity
      description: 'Threat severity. Possible values: "PHISH", "SPEAR", or "COMPROMISED_EMAIL"'
      type: String
    - contextPath: Hoxhunt.Threat.From.Name
      description: 'Email message sender name'
      type: String
    - contextPath: Hoxhunt.Threat.From.Address
      description: 'Email message sender address'
      type: String
    - contextPath: Hoxhunt.Threat.Attachments.Name
      description: 'Attachment file name'
      type: String
    - contextPath: Hoxhunt.Threat.Attachments.Type
      description: 'Attachment file content type'
      type: String
    - contextPath: Hoxhunt.Threat.Attachments.Hash
      description: 'Attachment file content hash value'
      type: String
    - contextPath: Hoxhunt.Threat.Attachments.Size
      description: 'Attachment file size in bytes'
      type: Number
    - contextPath: Hoxhunt.Threat.Hops.From
      description: 'Email server address the message bounced from'
      type: String
    - contextPath: Hoxhunt.Threat.Hops.By
      description: 'Email server address the message was directed to'
      type: String
    - contextPath: Hoxhunt.Threat.Links.Href
      description: 'Possibly malicious HTTP link parsed from the email message body'
      type: String
    - contextPath: Hoxhunt.Threat.Links.Label
      description: 'Text label associated with the link'
      type: String
    - contextPath: Hoxhunt.Threat.UserModifiers.ActedOnThreat
      description: 'Whether a user has acted on the Threat'
      type: Boolean
    - contextPath: Hoxhunt.Threat.UserModifiers.RepliedToEmail
      description: 'Whether a user has replied to the email message'
      type: Boolean
    - contextPath: Hoxhunt.Threat.UserModifiers.DownloadedFile
      description: 'Whether a user has downloaded an attachment file'
      type: Boolean
    - contextPath: Hoxhunt.Threat.UserModifiers.OpenedAttachment
      description: 'Whether a user has opened a downloaded attachment file'
      type: Boolean
    - contextPath: Hoxhunt.Threat.UserModifiers.VisitedLink
      description: 'Whether a user has opened a link in the email message'
      type: Boolean
    - contextPath: Hoxhunt.Threat.UserModifiers.EnteredCredentials
      description: 'Whether a user has entered their credentials to a form behind a link in the email message'
      type: Boolean
    - contextPath: Hoxhunt.Threat.UserModifiers.MarkedAsSpam
      description: 'Whether a user has marked the email message as spam'
      type: Boolean
    - contextPath: Hoxhunt.Threat.UserModifiers.Other
      description: 'Whether a user has acted on the threat in some other way'
      type: Boolean
  type: python
  subtype: python3
fromversion: 5.5.0
tests:
- No tests
